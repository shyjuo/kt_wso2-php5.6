<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>C++ code colored by C++2HTML</title>
<meta name="generator" content="C++2HTML by Jasper Bedaux" />
<!-- To generate your own colored code visit http://www.bedaux.net/cpp2html/ -->
<style type="text/css"> 
.comment { color: #999999; font-style: italic; }
.pre { color: #000099; }
.string { color: #009900; }
.char { color: #009900; }
.float { color: #996600; }
.int { color: #999900; }
.bool { color: #000000; font-weight: bold; }
.type { color: #FF6633; }
.flow { color: #FF0000; }
.keyword { color: #990000; }
.operator { color: #663300; font-weight: bold; }
</style>
</head>
<body>
<pre><span class="comment">/*
* Copyright 2005-2009 WSO2, Inc. http://wso2.com
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/</span><span class="pre">
 
 
#include &lt;stdio.h&gt;
#include &lt;ServiceClient.h&gt;
#include &lt;OMElement.h&gt;
#include &lt;iostream&gt;
#include &lt;AxisFault.h&gt;
#include &lt;Environment.h&gt;
</span><span class="keyword">
using namespace</span> std<span class="operator">;</span><span class="keyword">
using namespace</span> wso2wsf<span class="operator">;</span><span class="type">
 
int</span><span class="keyword"> main</span><span class="operator">(</span><span class="type">int</span> argc<span class="operator">,</span><span class="type"> char</span><span class="operator"> *</span>argv<span class="operator">[])
{</span>
	Environment<span class="operator">::</span>initialize<span class="operator">(</span><span class="string">"hello.log"</span><span class="operator">,</span> AXIS2_LOG_LEVEL_TRACE<span class="operator">);</span>
	
	string end_point<span class="operator"> =</span><span class="string"> "http://localhost:9090/axis2/services/hello"</span><span class="operator">;</span>
 
	ServiceClient sc<span class="operator">(</span>end_point<span class="operator">);</span>
 
	OMElement<span class="operator"> *</span> payload<span class="operator"> =</span><span class="keyword"> new</span> OMElement<span class="operator">(</span><span class="string">"greet"</span><span class="operator">);</span>
	payload<span class="operator">-&gt;</span>setText<span class="operator">(</span><span class="string">"Hello World!"</span><span class="operator">);</span><span class="flow">
	try</span><span class="operator">
	{</span>
		   OMElement<span class="operator">*</span> response<span class="operator"> =</span> sc<span class="operator">.</span>request<span class="operator">(</span>payload<span class="operator">,</span><span class="string"> ""</span><span class="operator">);</span><span class="flow">
			if</span><span class="operator"> (</span>response<span class="operator">)
			{</span>
				cout<span class="operator"> &lt;&lt;</span> endl<span class="operator"> &lt;&lt;</span><span class="string"> "Response: "</span><span class="operator"> &lt;&lt;</span> response<span class="operator"> &lt;&lt;</span> endl<span class="operator">;
			}
		}</span><span class="flow">
		catch</span><span class="operator"> (</span>AxisFault<span class="operator"> &amp;</span> e<span class="operator">)
		{</span><span class="flow">
			if</span><span class="operator"> (</span>sc<span class="operator">.</span>getLastSOAPFault<span class="operator">())
			{</span>
				cout<span class="operator"> &lt;&lt;</span> endl<span class="operator"> &lt;&lt;</span><span class="string"> "Fault: "</span><span class="operator"> &lt;&lt;</span> sc<span class="operator">.</span>getLastSOAPFault<span class="operator">() &lt;&lt;</span> endl<span class="operator">;
			}</span><span class="flow">
			else</span><span class="operator">
			{</span>
				cout<span class="operator"> &lt;&lt;</span> endl<span class="operator"> &lt;&lt;</span><span class="string"> "Error: "</span><span class="operator"> &lt;&lt;</span> e<span class="operator"> &lt;&lt;</span> endl<span class="operator">;
			}
		}</span><span class="keyword">
		delete</span> payload<span class="operator">;
	}</span>
 
</pre>
</body>
</html>

